<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-gb">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Artifacts - ContinuousPipe Docs</title>
    <meta name="generator" content="Hugo 0.18" />

    
    <meta name="description" content="Documentation for ContinuousPipe">
    
    <link rel="canonical" href="/docs/configuration/artifacts/">
    
    <meta name="author" content="Samuel RozÃ©">
    

    <meta property="og:url" content="/docs/configuration/artifacts/">
    <meta property="og:title" content="ContinuousPipe Docs">
    <meta property="og:image" content="/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="ContinuousPipe Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="/docs/images/favicon.png">
    <link rel="icon" type="image/x-icon" href="/docs/images/favicon.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/docs/fonts/icon.eot');
        src: url('/docs/fonts/icon.eot')
               format('embedded-opentype'),
             url('/docs/fonts/icon.woff')
               format('woff'),
             url('/docs/fonts/icon.ttf')
               format('truetype'),
             url('/docs/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="/docs/stylesheets/application.css">
    <link rel="stylesheet" href="/docs/stylesheets/temporary.css">
    <link rel="stylesheet" href="/docs/stylesheets/palettes.css">
    <link rel="stylesheet" href="/docs/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open%20Sans:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
    
    <link rel="stylesheet" href="/docs/stylesheets/custom.css">
    
    <script src="/docs/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-teal">


<div class="backdrop">
    <div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
    <nav aria-label="Header">
    <div class="bar default">
        <div class="button button-menu" role="button" aria-label="Menu">
            <label class="toggle-button icon icon-menu" for="toggle-drawer">
                <span></span>
            </label>
        </div>
        <div class="stretch">
            <div class="title">
                <a href="https://continuouspipe.github.io/" class="cp-website-link"><i class="cp-icon-logo"></i></a>
                <a href="/docs/">ContinuousPipe
                    Documentation</a>
            </div>
        </div>

        
        <div class="button button-twitter" role="button" aria-label="Twitter">
            <a href="https://twitter.com/continuouspipe" title="@continuouspipe on Twitter" target="_blank"
               class="toggle-button icon icon-twitter"></a>
        </div>
        

        
        <div class="button button-github" role="button" aria-label="GitHub">
            <a href="https://github.com/continuouspipe" title="@continuouspipe on GitHub" target="_blank"
               class="toggle-button icon icon-github"></a>
        </div>
        

        <div class="button button-search" role="button" aria-label="Search">
            <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
        </div>
    </div>
    <div class="bar search">
        <div class="button button-close" role="button" aria-label="Close">
            <label class="toggle-button icon icon-back" for="toggle-search"></label>
        </div>
        <div class="stretch">
            <div class="field">
                <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off"
                       autocomplete="off" spellcheck id="algolia-query">
            </div>
        </div>
        <div class="button button-reset" role="button" aria-label="Search">
            <button class="toggle-button icon icon-close" id="reset-search"></button>
        </div>
    </div>
</nav>

</header>

<main class="main">
    <div class="drawer">
        <nav aria-label="Navigation">
  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          



    
    
    <li>
        



<a  title="Basics" href="/docs/basics/">
	
	Basics
</a>


        
        <ul >
           
            
            



<a  title="ContinuousPipe" href="/docs/basics/continuous-pipe/">
	
	ContinuousPipe
</a>

           
            
            



<a  title="Concepts: ContinuousPipe Concepts" href="/docs/basics/concepts-continuous-pipe-concepts/">
	
	Concepts: ContinuousPipe Concepts
</a>

           
            
            



<a  title="Concepts: Configuration Concepts" href="/docs/basics/concepts-configuration-concepts/">
	
	Concepts: Configuration Concepts
</a>

           
            
            



<a  title="Concepts: Build Concepts" href="/docs/basics/concepts-build-concepts/">
	
	Concepts: Build Concepts
</a>

           
            
            



<a  title="Concepts: Deployment Concepts" href="/docs/basics/concepts-deployment-concepts/">
	
	Concepts: Deployment Concepts
</a>

           
            
            



<a  title="Workflow Principles" href="/docs/basics/workflow-principles/">
	
	Workflow Principles
</a>

           
            
            



<a  title="Installation: GitHub" href="/docs/basics/installation-github/">
	
	Installation: GitHub
</a>

           
            
            



<a  title="Installation: Bitbucket" href="/docs/basics/installation-bitbucket/">
	
	Installation: Bitbucket
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Quick Start" href="/docs/quick-start/">
	
	Quick Start
</a>


        
        <ul >
           
            
            



<a  title="Creating a Project" href="/docs/quick-start/creating-a-project/">
	
	Creating a Project
</a>

           
            
            



<a  title="Creating a Flow" href="/docs/quick-start/creating-a-flow/">
	
	Creating a Flow
</a>

           
            
            



<a  title="Configuring Users" href="/docs/quick-start/configuring-users/">
	
	Configuring Users
</a>

           
            
            



<a  title="Configuring a Cluster" href="/docs/quick-start/configuring-a-cluster/">
	
	Configuring a Cluster
</a>

           
            
            



<a  title="Configuring a Registry" href="/docs/quick-start/configuring-a-registry/">
	
	Configuring a Registry
</a>

           
            
            



<a  title="Configuring Your Repository" href="/docs/quick-start/configuring-your-repository/">
	
	Configuring Your Repository
</a>

           
            
            



<a  title="Configuring a Flow" href="/docs/quick-start/configuring-a-flow/">
	
	Configuring a Flow
</a>

           
            
            



<a  title="Creating a Tide" href="/docs/quick-start/creating-a-tide/">
	
	Creating a Tide
</a>

           
            
            



<a  title="Remote Development: Installing the Client" href="/docs/quick-start/remote-development-installing-the-client/">
	
	Remote Development: Installing the Client
</a>

           
            
            



<a  title="Remote Development: Configuring Your Repository" href="/docs/quick-start/remote-development-configuring-your-repository/">
	
	Remote Development: Configuring Your Repository
</a>

           
            
            



<a  title="Remote Development: Creating a Remote Environment" href="/docs/quick-start/remote-development-creating-a-remote-environment/">
	
	Remote Development: Creating a Remote Environment
</a>

           
            
            



<a  title="Remote Development: Using a Remote Environment" href="/docs/quick-start/remote-development-using-a-remote-environment/">
	
	Remote Development: Using a Remote Environment
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a class="current" title="Configuration" href="/docs/configuration/">
	
	Configuration
</a>


        
        <ul class="current">
           
            
            



<a  title="Configuration Files" href="/docs/configuration/configuration-files/">
	
	Configuration Files
</a>

           
            
            



<a  title="Tasks" href="/docs/configuration/tasks/">
	
	Tasks
</a>

           
            
            



<a  title="Tasks: Building Docker Images" href="/docs/configuration/tasks-build/">
	
	Tasks: Building Docker Images
</a>

           
            
            



<a  title="Tasks: Deploying Services" href="/docs/configuration/tasks-deploy/">
	
	Tasks: Deploying Services
</a>

           
            
            



<a  title="Tasks: Running Commands" href="/docs/configuration/tasks-run/">
	
	Tasks: Running Commands
</a>

           
            
            



<a  title="Tasks: Waiting Statuses" href="/docs/configuration/tasks-wait/">
	
	Tasks: Waiting Statuses
</a>

           
            
            



<a  title="Tasks: Manual Approval" href="/docs/configuration/tasks-manual-approval/">
	
	Tasks: Manual Approval
</a>

           
            
            



<a  title="Tasks: Creating Webhooks" href="/docs/configuration/tasks-webhook/">
	
	Tasks: Creating Webhooks
</a>

           
            
            



<a  title="Notifications" href="/docs/configuration/notifications/">
	
	Notifications
</a>

           
            
            



<a  title="Pipelines" href="/docs/configuration/pipelines/">
	
	Pipelines
</a>

           
            
            



<a  title="Cloudflare Integration" href="/docs/configuration/cloudflare-integration/">
	
	Cloudflare Integration
</a>

           
            
            



<a  title="Endpoints" href="/docs/configuration/endpoints/">
	
	Endpoints
</a>

           
            
            



<a class="current" title="Artifacts" href="/docs/configuration/artifacts/">
	
	Artifacts
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Remote Development" href="/docs/remote-development/">
	
	Remote Development
</a>


        
        <ul >
           
            
            



<a  title="Getting Started" href="/docs/remote-development/getting-started/">
	
	Getting Started
</a>

           
            
            



<a  title="Working with a Different Environment" href="/docs/remote-development/working-with-different-environments/">
	
	Working with a Different Environment
</a>

           
            
            



<a  title="Working with a Direct Connection to the Cluster" href="/docs/remote-development/working-with-direct-cluster-connection/">
	
	Working with a Direct Connection to the Cluster
</a>

           
            
            



<a  title="Advanced Setup" href="/docs/remote-development/advanced-setup/">
	
	Advanced Setup
</a>

           
            
            



<a  title="Command: Init" href="/docs/remote-development/command-init/">
	
	Command: Init
</a>

           
            
            



<a  title="Command: Setup" href="/docs/remote-development/command-setup/">
	
	Command: Setup
</a>

           
            
            



<a  title="Command: Build" href="/docs/remote-development/command-build/">
	
	Command: Build
</a>

           
            
            



<a  title="Command: Logs" href="/docs/remote-development/command-logs/">
	
	Command: Logs
</a>

           
            
            



<a  title="Command: Bash" href="/docs/remote-development/command-bash/">
	
	Command: Bash
</a>

           
            
            



<a  title="Command: Exec" href="/docs/remote-development/command-exec/">
	
	Command: Exec
</a>

           
            
            



<a  title="Command: Watch" href="/docs/remote-development/command-watch/">
	
	Command: Watch
</a>

           
            
            



<a  title="Command: Fetch" href="/docs/remote-development/command-fetch/">
	
	Command: Fetch
</a>

           
            
            



<a  title="Command: Push" href="/docs/remote-development/command-push/">
	
	Command: Push
</a>

           
            
            



<a  title="Command: Sync" href="/docs/remote-development/command-sync/">
	
	Command: Sync
</a>

           
            
            



<a  title="Command: Delete" href="/docs/remote-development/command-delete/">
	
	Command: Delete
</a>

           
            
            



<a  title="Command: Forward" href="/docs/remote-development/command-forward/">
	
	Command: Forward
</a>

           
            
            



<a  title="Command: Pods" href="/docs/remote-development/command-pods/">
	
	Command: Pods
</a>

           
            
            



<a  title="Command: Check Connection" href="/docs/remote-development/command-check-connection/">
	
	Command: Check Connection
</a>

           
            
            



<a  title="Command: Destroy" href="/docs/remote-development/command-destroy/">
	
	Command: Destroy
</a>

           
            
            



<a  title="Release Notes v0.1.0" href="/docs/remote-development/release-notes-0-1-0/">
	
	Release Notes v0.1.0
</a>

           
            
            



<a  title="Release Notes v0.1.1" href="/docs/remote-development/release-notes-0-1-1/">
	
	Release Notes v0.1.1
</a>

           
            
            



<a  title="Release Notes v0.1.2" href="/docs/remote-development/release-notes-0-1-2/">
	
	Release Notes v0.1.2
</a>

           
            
            



<a  title="Release Notes v0.1.3" href="/docs/remote-development/release-notes-0-1-3/">
	
	Release Notes v0.1.3
</a>

           
            
            



<a  title="Release Notes v0.1.4" href="/docs/remote-development/release-notes-0-1-4/">
	
	Release Notes v0.1.4
</a>

           
            
            



<a  title="Release Notes v0.1.5" href="/docs/remote-development/release-notes-0-1-5/">
	
	Release Notes v0.1.5
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="FAQ" href="/docs/faq/">
	
	FAQ
</a>


        
        <ul >
           
            
            



<a  title="Billing Profile" href="/docs/faq/how-do-I-create-a-billing-profile/">
	
	Billing Profile
</a>

           
            
            



<a  title="ContinuousPipe Images" href="/docs/faq/what-are-the-continuous-pipe-images/">
	
	ContinuousPipe Images
</a>

           
            
            



<a  title="ContinuousPipe Demo Sites" href="/docs/faq/what-are-the-continuous-pipe-demo-sites/">
	
	ContinuousPipe Demo Sites
</a>

           
            
            



<a  title="ContinuousPipe API Keys" href="/docs/faq/where-can-I-get-a-continuous-pipe-api-key/">
	
	ContinuousPipe API Keys
</a>

           
            
            



<a  title="Deployment Logs and Events" href="/docs/faq/where-can-I-view-container-logs-and-events/">
	
	Deployment Logs and Events
</a>

           
            
            



<a  title="Setting Environment Variables" href="/docs/faq/how-do-I-set-environment-variables/">
	
	Setting Environment Variables
</a>

           
            
            



<a  title="Controlling Deployments" href="/docs/faq/how-do-I-control-deployments-using-pr-labels/">
	
	Controlling Deployments
</a>

           
            
            



<a  title="Using Defaults" href="/docs/faq/how-do-I-use-defaults-to-reduce-the-duplication-of-configuration/">
	
	Using Defaults
</a>

           
            
            



<a  title="Setup GitHub Token" href="/docs/faq/how-do-I-use-composer-with-github-access-token/">
	
	Setup GitHub Token
</a>

           
            
            



<a  title="Using Pipelines" href="/docs/faq/how-do-I-use-pipelines-to-simplify-the-configuration/">
	
	Using Pipelines
</a>

           
            
            



<a  title="Basic Authentication" href="/docs/faq/how-do-I-add-basic-http-authentication-to-an-application/">
	
	Basic Authentication
</a>

           
            
            



<a  title="Overriding Tasks" href="/docs/faq/how-do-I-override-tasks-in-pipelines/">
	
	Overriding Tasks
</a>

           
            
            



<a  title="Manual Approval" href="/docs/faq/how-do-I-set-up-manual-approval-of-deployments/">
	
	Manual Approval
</a>

           
            
            



<a  title="Readiness Checks on Services" href="/docs/faq/how-do-I-define-a-readiness-check-when-deploying-services/">
	
	Readiness Checks on Services
</a>

           
            
            



<a  title="Get Endpoint Address for a Service" href="/docs/faq/how-do-I-get-the-deployed-endpoint-address-for-a-service/">
	
	Get Endpoint Address for a Service
</a>

           
            
            



<a  title="Slack Notifications" href="/docs/faq/how-do-I-configure-slack-notifications/">
	
	Slack Notifications
</a>

           
            
            



<a  title="Watch Commands and Inotify" href="/docs/faq/how-do-I-configure-inotify-for-development-tool-watch-commands/">
	
	Watch Commands and Inotify
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Guides" href="/docs/guides/">
	
	Guides
</a>


        
        <ul >
           
            
            



<a  title="Getting Started with Laravel" href="/docs/guides/laravel/">
	
	Getting Started with Laravel
</a>

           
            
            



<a  title="Getting Started with Symfony" href="/docs/guides/symfony/">
	
	Getting Started with Symfony
</a>

           
            
            



<a  title="Getting Started with Drupal" href="/docs/guides/drupal/">
	
	Getting Started with Drupal
</a>

           
            
            



<a  title="Xdebug Remote Environment" href="/docs/guides/remote-environment-xdebug/">
	
	Xdebug Remote Environment
</a>

          
        </ul>
      
    </li>



        </ul>
        

      </div>
    </div>
  </div>
</nav>

    </div>

    <article class="article">
        <div class="wrapper">
            
<h1>Artifacts </h1>



<h2 id="why-use-artifacts">Why Use Artifacts?</h2>

<p>Artifacts are a ContinuousPipe feature that can be used to solve the problems of:</p>

<ul>
<li><strong>Insecure images</strong> - where an image contains secret values used during the build process</li>
<li><strong>Large images</strong> - where an image contains build tools that are not needed beyond the build process</li>
</ul>

<p>These problems are addressed by introducing build steps to create separate images, and then using artifacts to copy files and folders from an initial build image to a secondary build image.</p>

<p><img src="/docs/images/configuration/multi-step-building.png" alt="" /></p>

<p>For example, you might create an initial build image containing a GitHub access token to pull the contents of a private Git repository, then create a secondary build image and copy the code across. The secondary image would only contain the code and none of the access credentials.</p>

<p>Similarly you might create an initial build image that uses Grunt to build your frontend code, which would need a combination of Ruby, Ruby gems, npm and npm modules to build the code. However, the secondary image would not require these tools once the code was copied across so would be much smaller.</p>

<h2 id="using-build-steps">Using Build Steps</h2>

<p>Artifacts are used in conjunction with build steps. The standard way to build an image is to use the following configuration, which is effectively a single build step:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span>
</pre></div>

<p>It defines a Docker image repository location to push the built image. It also assumes that a <code>Dockerfile</code> is present in the project root directory to provide instructions on how to build the image.</p>

<p>Using a build step, the above can also be written as follows:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">steps</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Dockerfile</span>
                          <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span> 
</pre></div>

<p>As you can see, the simple configuration has been replaced with a <code>steps</code> section, which explicitly defines where the <code>Dockerfile</code> is located as well as defining a Docker image repository location as before.</p>

<p>It is then quite straight forward to add an additional build step:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">steps</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Buildfile</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Dockerfile</span>
                          <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span> 
</pre></div>

<p>This will build two separate Docker images, however as we haven&rsquo;t introduced any artifacts yet the first image will effectively be built and then discarded, so the the net result will be the same as the previous examples.</p>

<p>It is also possible to specify a build directory, which works in conjunction with the Docker file path:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">steps</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Buildfile</span>
                          <span style="color: #ae81ff">build_directory</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./docker</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Dockerfile</span>
                          <span style="color: #ae81ff">build_directory</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./docker</span>
                          <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span> 
</pre></div>

<p>In this configuration the Docker file paths will be <code>./docker/Buildfile</code> and <code>./docker/Dockerfile</code> respectively.</p>

<h2 id="using-artifacts">Using Artifacts</h2>

<p>To enable artifacts, a <code>write_artifacts</code> and <code>read_artifacts</code> section needs to be added to separate build steps as follows:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">steps</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Buildfile</span>
                          <span style="color: #ae81ff">write_artifacts</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">built-files-artifact</span>
                                <span style="color: #ae81ff">path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">/app/built-files</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Dockerfile</span>
                          <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span>
                          <span style="color: #ae81ff">read_artifacts</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">built-files-artifact</span>
                                <span style="color: #ae81ff">path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">/built-files</span>
</pre></div>

<p>The <code>write_artifacts</code> section in the first build step creates a write artifact with name &ldquo;built-files-artifact&rdquo;. It then specifies a path of &ldquo;/app/built-files&rdquo; which represents the location where the Docker file <code>Buildfile</code> will place the results of the build process that it intends to share.</p>

<p>The <code>read_artifacts</code> section in the second build step creates a corresponding read artifact by referencing the same name as the write artifact i.e. &ldquo;built-files-artifact&rdquo;. It then specifies a path of &ldquo;/built-files&rdquo; which represents the location where the Docker file <code>Dockerfile</code> can expect to find the results of the build process that have been shared.</p>

<h3 id="docker-file-for-first-build-step">Docker File for First Build Step</h3>

<p>The following is a minimal example Docker file to demonstrate the interaction between the artifact and Docker in the first build step:</p>

<blockquote>
<p><strong>Buildfile</strong></p>

<pre><code>FROM nginx

RUN mkdir -p /app/built-files &amp;&amp; touch /app/built-files/test.txt &amp;&amp; echo &quot;test1234&quot; &gt; /app/built-files/test.txt
</code></pre>
</blockquote>

<p>This simply creates a directory that matches the path specified in the write artifact i.e &ldquo;/app/built-files&rdquo;, and then creates a file within the directory to populate the artifact.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In practice the contents of the &ldquo;/app/built-files&rdquo; directory would be the result of a build process.</p>
</div>

<h3 id="docker-file-for-second-build-step">Docker File for Second Build Step</h3>

<p>The following is a minimal example Docker file to demonstrate the interaction between the artifact and Docker in the second build step:</p>

<blockquote>
<p><strong>Dockerfile</strong></p>

<pre><code>FROM nginx

COPY ./built-files /usr/share/nginx/html
</code></pre>
</blockquote>

<p>This uses the Docker <a href="https://docs.docker.com/engine/reference/builder/#copy">COPY instruction</a> to import files into the image, copying them to the web server directory. It imports any files shared in the artifact by referencing the path specified in the read artifact prefixed by a full stop i.e &ldquo;./built-files&rdquo;. In this case there is just one file in the artifact, which will be copied from &ldquo;./built-files/test.txt&rdquo; to &ldquo;/usr/share/nginx/html/test.txt&rdquo;.</p>

<h2 id="using-artifacts-with-secrets">Using Artifacts With Secrets</h2>

<p>If your initial build image needs to use secure access credentials (such as an auth token) you can supply it as an environment variable:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">images</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">build</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">steps</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Buildfile</span>
                          <span style="color: #ae81ff">environment</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">GITHUB_TOKEN</span>
                                <span style="color: #ae81ff">value</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${GITHUB_TOKEN}</span>
                          <span style="color: #ae81ff">write_artifacts</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">built-files-artifact</span>
                                <span style="color: #ae81ff">path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">/app/built-files</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">docker_file_path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">./Dockerfile</span>
                          <span style="color: #ae81ff">image</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${IMAGE_NAME}</span>
                          <span style="color: #ae81ff">read_artifacts</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">built-files-artifact</span>
                                <span style="color: #ae81ff">path</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">/built-files</span>
</pre></div>

<p>Here the image in the first build step will be supplied with the enviroment variable <code>GITHUB_TOKEN</code>, but the image in the second build step will have no record of it.</p>

<p>The following is an example Docker file to demonstrate how the <code>GITHUB_TOKEN</code> will be used in the first build step:</p>

<blockquote>
<p><strong>Buildfile</strong></p>

<pre><code>FROM quay.io/continuouspipe/symfony-php7.1-nginx:stable

ARG GITHUB_TOKEN=

RUN composer config github-oauth.github.com $GITHUB_TOKEN &amp;&amp; \
    composer install -o --no-interaction &amp;&amp; \
    composer clear-cache
</code></pre>
</blockquote>



        </div>
    </article>

    <footer class="footer" style="margin-top: 20px;">
        





<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="/docs/configuration/endpoints/" title="Endpoints">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Endpoints
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
  </div>
</nav>





    </footer>

    <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
            <div class="wrapper">
                <div class="meta"></div>
                <div class="list"></div>
            </div>
        </div>
    </div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="/docs/javascripts/application.js"></script>
    
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
    
    <script src="/docs/javascripts/jquery-3.1.1.min.js"></script>
    
    <script src="/docs/javascripts/menu.js"></script>
    

    <script>
    /* Removes redundant event listener from material theme */
    window.addEventListener('load', function () {
        var searchToggle = document.querySelector("#toggle-search");
        var searchLabel = document.querySelector("[for=\"toggle-search\"]");
        var algoliaInput = document.querySelector("#algolia-query");

        function elementReset(elem) {
            elem.parentNode.replaceChild(elem.cloneNode(true), elem);
        }

        elementReset(searchToggle);
        searchLabel.addEventListener('click', function() {
            algoliaInput.focus();
        }, false);
    }, false);
    </script>

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>
    <script type="text/javascript"> 
    docsearch({
        apiKey: '608036855612fb9a0dd2e9a2c09955bc',
        indexName: 'continuouspipe',
        inputSelector: '#algolia-query',
        debug: true 
    });
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-71216332-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>

