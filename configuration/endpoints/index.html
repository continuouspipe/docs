<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-gb">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Endpoints - ContinuousPipe Docs</title>
    <meta name="generator" content="Hugo 0.18" />

    
    <meta name="description" content="Documentation for ContinuousPipe">
    
    <link rel="canonical" href="../../docs/configuration/endpoints/">
    
    <meta name="author" content="Samuel RozÃ©">
    

    <meta property="og:url" content="/docs/configuration/endpoints/">
    <meta property="og:title" content="ContinuousPipe Docs">
    <meta property="og:image" content="/docs/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="ContinuousPipe Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../docs/images/favicon.png">
    <link rel="icon" type="image/x-icon" href="../../docs/images/favicon.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('/docs/fonts/icon.eot');
        src: url('/docs/fonts/icon.eot')
               format('embedded-opentype'),
             url('/docs/fonts/icon.woff')
               format('woff'),
             url('/docs/fonts/icon.ttf')
               format('truetype'),
             url('/docs/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../docs/stylesheets/application.css">
    <link rel="stylesheet" href="../../docs/stylesheets/temporary.css">
    <link rel="stylesheet" href="../../docs/stylesheets/palettes.css">
    <link rel="stylesheet" href="../../docs/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open%20Sans:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
    
    <link rel="stylesheet" href="../../docs/stylesheets/custom.css">
    
    <script src="../../docs/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-teal">


<div class="backdrop">
    <div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
    <nav aria-label="Header">
    <div class="bar default">
        <div class="button button-menu" role="button" aria-label="Menu">
            <label class="toggle-button icon icon-menu" for="toggle-drawer">
                <span></span>
            </label>
        </div>
        <div class="stretch">
            <div class="title">
                <a href="https://continuouspipe.github.io/" class="cp-website-link"><i class="cp-icon-logo"></i></a>
                <a href="../../docs/">ContinuousPipe
                    Documentation</a>
            </div>
        </div>

        
        <div class="button button-twitter" role="button" aria-label="Twitter">
            <a href="https://twitter.com/continuouspipe" title="@continuouspipe on Twitter" target="_blank"
               class="toggle-button icon icon-twitter"></a>
        </div>
        

        
        <div class="button button-github" role="button" aria-label="GitHub">
            <a href="https://github.com/continuouspipe" title="@continuouspipe on GitHub" target="_blank"
               class="toggle-button icon icon-github"></a>
        </div>
        

        <div class="button button-search" role="button" aria-label="Search">
            <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
        </div>
    </div>
    <div class="bar search">
        <div class="button button-close" role="button" aria-label="Close">
            <label class="toggle-button icon icon-back" for="toggle-search"></label>
        </div>
        <div class="stretch">
            <div class="field">
                <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off"
                       autocomplete="off" spellcheck id="algolia-query">
            </div>
        </div>
        <div class="button button-reset" role="button" aria-label="Search">
            <button class="toggle-button icon icon-close" id="reset-search"></button>
        </div>
    </div>
</nav>

</header>

<main class="main">
    <div class="drawer">
        <nav aria-label="Navigation">
  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          



    
    
    <li>
        



<a  title="Basics" href="../../docs/basics/">
	
	Basics
</a>


        
        <ul >
           
            
            



<a  title="ContinuousPipe" href="../../docs/basics/continuous-pipe/">
	
	ContinuousPipe
</a>

           
            
            



<a  title="Concepts: ContinuousPipe Concepts" href="../../docs/basics/concepts-continuous-pipe-concepts/">
	
	Concepts: ContinuousPipe Concepts
</a>

           
            
            



<a  title="Concepts: Configuration Concepts" href="../../docs/basics/concepts-configuration-concepts/">
	
	Concepts: Configuration Concepts
</a>

           
            
            



<a  title="Concepts: Build Concepts" href="../../docs/basics/concepts-build-concepts/">
	
	Concepts: Build Concepts
</a>

           
            
            



<a  title="Concepts: Deployment Concepts" href="../../docs/basics/concepts-deployment-concepts/">
	
	Concepts: Deployment Concepts
</a>

           
            
            



<a  title="Workflow Principles" href="../../docs/basics/workflow-principles/">
	
	Workflow Principles
</a>

           
            
            



<a  title="Installation: GitHub" href="../../docs/basics/installation-github/">
	
	Installation: GitHub
</a>

           
            
            



<a  title="Installation: Bitbucket" href="../../docs/basics/installation-bitbucket/">
	
	Installation: Bitbucket
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Quick Start" href="../../docs/quick-start/">
	
	Quick Start
</a>


        
        <ul >
           
            
            



<a  title="Creating a Project" href="../../docs/quick-start/creating-a-project/">
	
	Creating a Project
</a>

           
            
            



<a  title="Creating a Flow" href="../../docs/quick-start/creating-a-flow/">
	
	Creating a Flow
</a>

           
            
            



<a  title="Configuring Users" href="../../docs/quick-start/configuring-users/">
	
	Configuring Users
</a>

           
            
            



<a  title="Configuring a Cluster" href="../../docs/quick-start/configuring-a-cluster/">
	
	Configuring a Cluster
</a>

           
            
            



<a  title="Configuring a Registry" href="../../docs/quick-start/configuring-a-registry/">
	
	Configuring a Registry
</a>

           
            
            



<a  title="Configuring Your Repository" href="../../docs/quick-start/configuring-your-repository/">
	
	Configuring Your Repository
</a>

           
            
            



<a  title="Configuring a Flow" href="../../docs/quick-start/configuring-a-flow/">
	
	Configuring a Flow
</a>

           
            
            



<a  title="Creating a Tide" href="../../docs/quick-start/creating-a-tide/">
	
	Creating a Tide
</a>

           
            
            



<a  title="Remote Development: Installing the Client" href="../../docs/quick-start/remote-development-installing-the-client/">
	
	Remote Development: Installing the Client
</a>

           
            
            



<a  title="Remote Development: Configuring Your Repository" href="../../docs/quick-start/remote-development-configuring-your-repository/">
	
	Remote Development: Configuring Your Repository
</a>

           
            
            



<a  title="Remote Development: Creating a Remote Environment" href="../../docs/quick-start/remote-development-creating-a-remote-environment/">
	
	Remote Development: Creating a Remote Environment
</a>

           
            
            



<a  title="Remote Development: Using a Remote Environment" href="../../docs/quick-start/remote-development-using-a-remote-environment/">
	
	Remote Development: Using a Remote Environment
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a class="current" title="Configuration" href="../../docs/configuration/">
	
	Configuration
</a>


        
        <ul class="current">
           
            
            



<a  title="Configuration Files" href="../../docs/configuration/configuration-files/">
	
	Configuration Files
</a>

           
            
            



<a  title="Tasks" href="../../docs/configuration/tasks/">
	
	Tasks
</a>

           
            
            



<a  title="Tasks: Building Docker Images" href="../../docs/configuration/tasks-build/">
	
	Tasks: Building Docker Images
</a>

           
            
            



<a  title="Tasks: Deploying Services" href="../../docs/configuration/tasks-deploy/">
	
	Tasks: Deploying Services
</a>

           
            
            



<a  title="Tasks: Running Commands" href="../../docs/configuration/tasks-run/">
	
	Tasks: Running Commands
</a>

           
            
            



<a  title="Tasks: Waiting Statuses" href="../../docs/configuration/tasks-wait/">
	
	Tasks: Waiting Statuses
</a>

           
            
            



<a  title="Tasks: Manual Approval" href="../../docs/configuration/tasks-manual-approval/">
	
	Tasks: Manual Approval
</a>

           
            
            



<a  title="Tasks: Creating Webhooks" href="../../docs/configuration/tasks-webhook/">
	
	Tasks: Creating Webhooks
</a>

           
            
            



<a  title="Notifications" href="../../docs/configuration/notifications/">
	
	Notifications
</a>

           
            
            



<a  title="Pipelines" href="../../docs/configuration/pipelines/">
	
	Pipelines
</a>

           
            
            



<a  title="Cloudflare Integration" href="../../docs/configuration/cloudflare-integration/">
	
	Cloudflare Integration
</a>

           
            
            



<a class="current" title="Endpoints" href="../../docs/configuration/endpoints/">
	
	Endpoints
</a>

           
            
            



<a  title="Artifacts" href="../../docs/configuration/artifacts/">
	
	Artifacts
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Remote Development" href="../../docs/remote-development/">
	
	Remote Development
</a>


        
        <ul >
           
            
            



<a  title="Getting Started" href="../../docs/remote-development/getting-started/">
	
	Getting Started
</a>

           
            
            



<a  title="Working with a Different Environment" href="../../docs/remote-development/working-with-different-environments/">
	
	Working with a Different Environment
</a>

           
            
            



<a  title="Working with a Direct Connection to the Cluster" href="../../docs/remote-development/working-with-direct-cluster-connection/">
	
	Working with a Direct Connection to the Cluster
</a>

           
            
            



<a  title="Advanced Setup" href="../../docs/remote-development/advanced-setup/">
	
	Advanced Setup
</a>

           
            
            



<a  title="Command: Init" href="../../docs/remote-development/command-init/">
	
	Command: Init
</a>

           
            
            



<a  title="Command: Setup" href="../../docs/remote-development/command-setup/">
	
	Command: Setup
</a>

           
            
            



<a  title="Command: Build" href="../../docs/remote-development/command-build/">
	
	Command: Build
</a>

           
            
            



<a  title="Command: Logs" href="../../docs/remote-development/command-logs/">
	
	Command: Logs
</a>

           
            
            



<a  title="Command: Bash" href="../../docs/remote-development/command-bash/">
	
	Command: Bash
</a>

           
            
            



<a  title="Command: Exec" href="../../docs/remote-development/command-exec/">
	
	Command: Exec
</a>

           
            
            



<a  title="Command: Watch" href="../../docs/remote-development/command-watch/">
	
	Command: Watch
</a>

           
            
            



<a  title="Command: Fetch" href="../../docs/remote-development/command-fetch/">
	
	Command: Fetch
</a>

           
            
            



<a  title="Command: Push" href="../../docs/remote-development/command-push/">
	
	Command: Push
</a>

           
            
            



<a  title="Command: Sync" href="../../docs/remote-development/command-sync/">
	
	Command: Sync
</a>

           
            
            



<a  title="Command: Delete" href="../../docs/remote-development/command-delete/">
	
	Command: Delete
</a>

           
            
            



<a  title="Command: Forward" href="../../docs/remote-development/command-forward/">
	
	Command: Forward
</a>

           
            
            



<a  title="Command: Pods" href="../../docs/remote-development/command-pods/">
	
	Command: Pods
</a>

           
            
            



<a  title="Command: Check Connection" href="../../docs/remote-development/command-check-connection/">
	
	Command: Check Connection
</a>

           
            
            



<a  title="Command: Destroy" href="../../docs/remote-development/command-destroy/">
	
	Command: Destroy
</a>

           
            
            



<a  title="Release Notes v0.1.0" href="../../docs/remote-development/release-notes-0-1-0/">
	
	Release Notes v0.1.0
</a>

           
            
            



<a  title="Release Notes v0.1.1" href="../../docs/remote-development/release-notes-0-1-1/">
	
	Release Notes v0.1.1
</a>

           
            
            



<a  title="Release Notes v0.1.2" href="../../docs/remote-development/release-notes-0-1-2/">
	
	Release Notes v0.1.2
</a>

           
            
            



<a  title="Release Notes v0.1.3" href="../../docs/remote-development/release-notes-0-1-3/">
	
	Release Notes v0.1.3
</a>

           
            
            



<a  title="Release Notes v0.1.4" href="../../docs/remote-development/release-notes-0-1-4/">
	
	Release Notes v0.1.4
</a>

           
            
            



<a  title="Release Notes v0.1.5" href="../../docs/remote-development/release-notes-0-1-5/">
	
	Release Notes v0.1.5
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="FAQ" href="../../docs/faq/">
	
	FAQ
</a>


        
        <ul >
           
            
            



<a  title="Billing Profile" href="../../docs/faq/how-do-I-create-a-billing-profile/">
	
	Billing Profile
</a>

           
            
            



<a  title="ContinuousPipe Images" href="../../docs/faq/what-are-the-continuous-pipe-images/">
	
	ContinuousPipe Images
</a>

           
            
            



<a  title="ContinuousPipe Demo Sites" href="../../docs/faq/what-are-the-continuous-pipe-demo-sites/">
	
	ContinuousPipe Demo Sites
</a>

           
            
            



<a  title="ContinuousPipe API Keys" href="../../docs/faq/where-can-I-get-a-continuous-pipe-api-key/">
	
	ContinuousPipe API Keys
</a>

           
            
            



<a  title="Deployment Logs and Events" href="../../docs/faq/where-can-I-view-container-logs-and-events/">
	
	Deployment Logs and Events
</a>

           
            
            



<a  title="Setting Environment Variables" href="../../docs/faq/how-do-I-set-environment-variables/">
	
	Setting Environment Variables
</a>

           
            
            



<a  title="Controlling Deployments" href="../../docs/faq/how-do-I-control-deployments-using-pr-labels/">
	
	Controlling Deployments
</a>

           
            
            



<a  title="Using Defaults" href="../../docs/faq/how-do-I-use-defaults-to-reduce-the-duplication-of-configuration/">
	
	Using Defaults
</a>

           
            
            



<a  title="Setup GitHub Token" href="../../docs/faq/how-do-I-use-composer-with-github-access-token/">
	
	Setup GitHub Token
</a>

           
            
            



<a  title="Using Pipelines" href="../../docs/faq/how-do-I-use-pipelines-to-simplify-the-configuration/">
	
	Using Pipelines
</a>

           
            
            



<a  title="Basic Authentication" href="../../docs/faq/how-do-I-add-basic-http-authentication-to-an-application/">
	
	Basic Authentication
</a>

           
            
            



<a  title="Overriding Tasks" href="../../docs/faq/how-do-I-override-tasks-in-pipelines/">
	
	Overriding Tasks
</a>

           
            
            



<a  title="Manual Approval" href="../../docs/faq/how-do-I-set-up-manual-approval-of-deployments/">
	
	Manual Approval
</a>

           
            
            



<a  title="Readiness Checks on Services" href="../../docs/faq/how-do-I-define-a-readiness-check-when-deploying-services/">
	
	Readiness Checks on Services
</a>

           
            
            



<a  title="Get Endpoint Address for a Service" href="../../docs/faq/how-do-I-get-the-deployed-endpoint-address-for-a-service/">
	
	Get Endpoint Address for a Service
</a>

           
            
            



<a  title="Slack Notifications" href="../../docs/faq/how-do-I-configure-slack-notifications/">
	
	Slack Notifications
</a>

           
            
            



<a  title="Watch Commands and Inotify" href="../../docs/faq/how-do-I-configure-inotify-for-development-tool-watch-commands/">
	
	Watch Commands and Inotify
</a>

          
        </ul>
      
    </li>



    
    
    <li>
        



<a  title="Guides" href="../../docs/guides/">
	
	Guides
</a>


        
        <ul >
           
            
            



<a  title="Getting Started with Laravel" href="../../docs/guides/laravel/">
	
	Getting Started with Laravel
</a>

           
            
            



<a  title="Getting Started with Symfony" href="../../docs/guides/symfony/">
	
	Getting Started with Symfony
</a>

           
            
            



<a  title="Getting Started with Drupal" href="../../docs/guides/drupal/">
	
	Getting Started with Drupal
</a>

           
            
            



<a  title="Xdebug Remote Environment" href="../../docs/guides/remote-environment-xdebug/">
	
	Xdebug Remote Environment
</a>

          
        </ul>
      
    </li>



        </ul>
        

      </div>
    </div>
  </div>
</nav>

    </div>

    <article class="article">
        <div class="wrapper">
            
<h1>Endpoints </h1>



<h2 id="using-a-standard-endpoint">Using a Standard Endpoint</h2>

<p>The standard way to expose your services to the internet is to use the following configuration:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #75715e"># ...</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">accessibility</span><span style="color: #f8f8f2">:</span>
                            <span style="color: #ae81ff">from_external</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">true</span>
</pre></div>

<p>This is fine for most purposes, but has it has three main limitations:</p>

<p><strong>1)</strong> It presents difficulties when trying to whitelist IP addresses for authentication as the client IP address is not passed through to the service. This can be resolved by using an annotation, which ensures that the client IP address is passed through to the service:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #75715e"># ...</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">endpoints</span><span style="color: #f8f8f2">:</span>
                      <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">www</span>
                        <span style="color: #ae81ff">annotations</span><span style="color: #f8f8f2">:</span>
                          <span style="color: #ae81ff">service.beta.kubernetes.io/external-traffic</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">OnlyLocal</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">accessibility</span><span style="color: #f8f8f2">:</span>
                            <span style="color: #ae81ff">from_external</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">true</span>
</pre></div>

<p><strong>2)</strong> The IP addresses are chosen from a random pool and by default are not static, which means they cannot be reliably associated with a DNS record.</p>

<p><strong>3)</strong> It uses a public IP address per service, which can be expensive.</p>

<h2 id="using-a-load-balancer">Using a Load Balancer</h2>

<p>Most cloud services offer the option of using a load balancer, which mitigates two of the above limitations - with a load balancer public IP addresses are passed through to the service, and the IP address of the load balancer is static so can be set up in a DNS record. However, using load balancers can also be expensive as you still use a public IP address for each service.</p>

<h2 id="using-the-nginx-ingress-controller">Using the Nginx Ingress Controller</h2>

<p>Using the <a href="https://github.com/kubernetes/ingress/tree/master/controllers/nginx">Nginx Ingress controller</a> presents an option that mitigates all three of the above limitations, as it only requires one public IP address - a series of rules can be used to determine how inbound connections are directed to your services. The Nginx Ingress controller also allows SSL to be configured in one place so removes the need to configure SSL for each service independently.</p>

<h3 id="installation">Installation</h3>

<p>ContinuousPipe currently provides no way to create the Nginx Ingress controller - this needs to be done as a manual step when setting up your Kubernetes cluster. Once the Ingress is deployed, it will be assigned an IP address from a random pool, which will then be static for the lifetime of the Ingress. The IP address of the manually deployed Ingress then needs to be set up in a DNS rule so that it is associated with your domain, unless you are using <a href="#nginx-ingress-with-cloudflare-ssl">Cloudflare integration</a>.</p>

<p><strong>You need an Ingress controller to be deployed on your cluster first.</strong> You can use the <a href="https://github.com/continuouspipe/nginx-ingress-controller">ContinuousPipe Ingress controller</a> or any of the official <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/#ingress-controllers">Kubernetes Ingress controllers</a>.</p>

<h3 id="continuouspipe-modifications">ContinuousPipe Modifications</h3>

<p>The Nginx Ingress controller used by ContinuousPipe is slightly modified from the default Kubernetes behaviour. The default Nginx Ingress controller only exposes port 443 if a SSL certificate with matching hostname is also configured. The ContinuousPipe Nginx Ingress controller extends that behaviour to allow port 443 to be exposed, using a wildcard SSL certificate if no matching hostname certificate is configured. Additionally, it allows Cloudflare SSL to be configured.</p>

<h3 id="nginx-ingress-with-no-ssl">Nginx Ingress With No SSL</h3>

<p>If you wish to use the Nginx Ingress without SSL, this can be done as follows:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #75715e"># ...</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">cluster</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLUSTER}</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">endpoints</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">webnossl</span>
                          <span style="color: #ae81ff">ingress</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #ae81ff">class</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">nginx</span>
                              <span style="color: #ae81ff">host_suffix</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;-example-with-no-ssl.yourdomain.com&#39;</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">ports</span><span style="color: #f8f8f2">:</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">80</span>
</pre></div>

<p>As you can see, the setup is quite straight forward. Within <code>endpoints</code>, the Ingress is defined as <code>nginx</code>. A <code>host_suffix</code> is supplied, which will be combined with the branch name to create the full URL e.g. a deployment of &ldquo;master&rdquo; branch would create an environment with URL &ldquo;http&#58;//master-example-with-no-ssl.yourdomain.com&rdquo;.</p>

<p>Additionally, port 80 is exposed, so traffic will just use HTTP.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need to set up a wildcard DNS rule associating the Ingress IP address with your domain name for this example to work.</p>

<p>e.g. <code>123.123.123.123 *example-with-no-ssl.yourdomain.com</code></p>
</div>

<h3 id="nginx-ingress-with-own-ssl">Nginx Ingress With Own SSL</h3>

<p>If you wish to use the Nginx Ingress with SSL, this can be done as follows:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #75715e"># ...</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">cluster</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLUSTER}</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">endpoints</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">webwithssl</span>
                          <span style="color: #ae81ff">ingress</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #ae81ff">class</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">nginx</span>
                              <span style="color: #ae81ff">host</span><span style="color: #f8f8f2">:</span>
                                  <span style="color: #ae81ff">expression</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;&quot;example-with-ssl.yourdomain.com&quot;&#39;</span>
                          <span style="color: #ae81ff">ssl_certificates</span><span style="color: #f8f8f2">:</span>
                            <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">webwithssl</span>
                              <span style="color: #ae81ff">key</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${SSL_KEY}</span>
                              <span style="color: #ae81ff">cert</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${SSL_CERT}</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">ports</span><span style="color: #f8f8f2">:</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">80</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">443</span>
</pre></div>

<p>This is similar to the previous configuration, but with important differences. Instead of using a <code>host_suffix</code>, a <code>host</code> expression is defined instead. This will create an environment using exactly &ldquo;<a href="https://example-with-ssl.yourdomain.com&quot;">https://example-with-ssl.yourdomain.com&quot;</a>.</p>

<p>The <code>ssl_certificates</code> section is used to define the certificate, which can be either an officially supplied certificate or a self signed certificate. As this isn&rsquo;t something you want to store in version control, the <code>key</code> and <code>cert</code> properties instead reference variables <code>${SSL_KEY}</code> and <code>${SSL_CERT}</code> respectively. The values need to be entered into the ContinuousPipe console as explained when <a href="../../docs/quick-start/configuring-a-flow/">configuring a flow</a>. The values entered should be base64 encoded.</p>

<p>In addition to port 80, port 443 is also exposed. This is needed to let ContinuousPipe know that you want to use HTTPS traffic.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need to set up a DNS rule associating the Ingress IP address with your domain name for this example to work.</p>

<p>e.g. <code>123.123.123.123 example-with-ssl.yourdomain.com</code></p>
</div>

<h3 id="nginx-ingress-with-wildcard-ssl">Nginx Ingress With Wildcard SSL</h3>

<p>If you wish to use the Nginx Ingress with wildcard SSL, this can be done as follows:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #75715e"># ...</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">cluster</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLUSTER}</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">endpoints</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">webwithwildcardssl</span>
                          <span style="color: #ae81ff">ingress</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #ae81ff">class</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">nginx</span>
                              <span style="color: #ae81ff">host</span><span style="color: #f8f8f2">:</span>
                                  <span style="color: #ae81ff">expression</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;&quot;example-with-wildcard-ssl.yourdomain.com&quot;&#39;</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">ports</span><span style="color: #f8f8f2">:</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">80</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">443</span>
</pre></div>

<p>This is similar to the previous configuration, but omits the <code>ssl_certificates</code>. However, as port 443 is still exposed ContinuousPipe will still set up SSL using wildcard certificates. This behaviour is distinct to the ContinuousPipe adaptation of the Nginx Ingress controller - the default Nginx Ingress controller would not set up SSL in this scenario.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need to set up a wildcard DNS rule associating the Ingress IP address with your domain name for this example to work.</p>

<p>e.g. <code>123.123.123.123 *example-with-wildcard-ssl.yourdomain.com</code></p>
</div>

<h3 id="nginx-ingress-with-cloudflare-ssl">Nginx Ingress With Cloudflare SSL</h3>

<p>ContinuousPipe already has <a href="../../docs/configuration/cloudflare-integration/">integration with Cloudflare</a> when configuring endpoints directly. This integration can also be applied to the Nginx Ingress. The major advantage of this is that it does not need a DNS rule setting up in advance, as Cloudflare will create this automatically.</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #ae81ff">tasks</span><span style="color: #f8f8f2">:</span>
    <span style="color: #75715e"># ...</span>
    <span style="color: #ae81ff">deployment</span><span style="color: #f8f8f2">:</span>
        <span style="color: #ae81ff">deploy</span><span style="color: #f8f8f2">:</span>
            <span style="color: #ae81ff">cluster</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLUSTER}</span>
            <span style="color: #ae81ff">services</span><span style="color: #f8f8f2">:</span>
                <span style="color: #ae81ff">web</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #ae81ff">endpoints</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">name</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">webwithcloudflaressl</span>
                          <span style="color: #ae81ff">cloud_flare_zone</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #ae81ff">zone_identifier</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLOUD_FLARE_ZONE}</span>
                              <span style="color: #ae81ff">authentication</span><span style="color: #f8f8f2">:</span>
                                  <span style="color: #ae81ff">email</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLOUD_FLARE_EMAIL}</span>
                                  <span style="color: #ae81ff">api_key</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">${CLOUD_FLARE_API_KEY}</span>
                              <span style="color: #ae81ff">proxied</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">true</span>
                              <span style="color: #ae81ff">record_suffix</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;-example-with-cloudflare-ssl.continuouspipe.net&#39;</span>
                          <span style="color: #ae81ff">ingress</span><span style="color: #f8f8f2">:</span>
                              <span style="color: #ae81ff">class</span><span style="color: #f8f8f2">:</span> <span style="color: #ae81ff">nginx</span>
                              <span style="color: #ae81ff">host_suffix</span><span style="color: #f8f8f2">:</span> <span style="color: #e6db74">&#39;-example-with-cloudflare-ssl.continuouspipe.net&#39;</span>
                    <span style="color: #ae81ff">specification</span><span style="color: #f8f8f2">:</span>
                        <span style="color: #ae81ff">ports</span><span style="color: #f8f8f2">:</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">80</span>
                          <span style="color: #f8f8f2">-</span> <span style="color: #ae81ff">443</span>
</pre></div>

<p>As you can see, the main difference is the addition of a <code>cloud_flare_zone</code> section, which defines how traffic should interact with Cloudflare. The values defined in <code>cloud_flare_zone</code> are explained in the <a href="../../docs/configuration/cloudflare-integration/">integration with Cloudflare</a> page.</p>

<p>Further down, the Ingress defines a <code>host_suffix</code> that matches the Cloudflare <code>record_suffix</code>, so that the environment URL and the Cloudflare DNS entry are matched.</p>



        </div>
    </article>

    <footer class="footer" style="margin-top: 20px;">
        





<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="../../docs/configuration/cloudflare-integration/" title="Cloudflare Integration">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Cloudflare Integration
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="../../docs/configuration/artifacts/" title="Artifacts">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Artifacts
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





    </footer>

    <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
            <div class="wrapper">
                <div class="meta"></div>
                <div class="list"></div>
            </div>
        </div>
    </div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../docs/javascripts/application.js"></script>
    
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
    
    <script src="../../docs/javascripts/jquery-3.1.1.min.js"></script>
    
    <script src="../../docs/javascripts/menu.js"></script>
    

    <script>
    /* Removes redundant event listener from material theme */
    window.addEventListener('load', function () {
        var searchToggle = document.querySelector("#toggle-search");
        var searchLabel = document.querySelector("[for=\"toggle-search\"]");
        var algoliaInput = document.querySelector("#algolia-query");

        function elementReset(elem) {
            elem.parentNode.replaceChild(elem.cloneNode(true), elem);
        }

        elementReset(searchToggle);
        searchLabel.addEventListener('click', function() {
            algoliaInput.focus();
        }, false);
    }, false);
    </script>

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>
    <script type="text/javascript"> 
    docsearch({
        apiKey: '608036855612fb9a0dd2e9a2c09955bc',
        indexName: 'continuouspipe',
        inputSelector: '#algolia-query',
        debug: true 
    });
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-71216332-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>

